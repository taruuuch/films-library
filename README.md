# **Films Library**

Веб-приложение для хранения информации о фильмах

## **Функционал**

- [x] Добавить фильм (проверки на ошибки происходят на сервере, что бы нельзя было обойти валидацию на фронте)
- [x] Удалить фильм (подтверждение через модальное окно)
- [x] Показать информацию о фильме
  - Уникальный идентификатор
  - Название фильма
  - Год выпуска
  - Формат (VHS, DVD, Blu-Ray)
  - Список актеров (“Имя и фамилия актера”)
- [x] Показать список фильмов отсортированных по названию в алфавитном порядке (список выводиться отсортированным)
- [x] Найти фильм по названию. (ищет фильмы по названи которые включают в себя введенное слово)
- [x] Найти фильм по имени актера. (ищет фильмы по актёру которые включают в себя введенного актёра)
- [x] Импорт фильмов с текстового файла (пример файла прилагается “sample_movies.txt”)
- [x] Файл должен загружаться через веб-интерфейс

### ***New***

- [x] Сборка и запуска проекта через Docker

### ***Feature***

- [ ] Добавить изображение фильма

## **Технологии**

### ***Backend***

- API
  - Node.js
  - Express
  - Security:
    - rate-limit
    - cors
    - helmet
  - Mongoose
  - Morgan (logger)
- Database
  - MongoDB

### ***Frontend***

- React
- Redux
- Redux-thunk
- React-router-dom
- [Semantic UI](https://react.semantic-ui.com/)

## **Установка и запуск**

### **Настройка переменных окружения**

Вам не понадобиться локальная база данных, так как она находится в облаке [MongoDB Atlas Сloud](https://cloud.mongodb.com), сервер автоматически подключится к базе данных при запуске.

Вам необходимо продублировать файл _.env.example_ с именем _.env_, в каталоге с сервером и проприсать в нем параметры для подключения к базе данных и порт для запуска сервера, что прописывать указано ниже:

#### *Сервер*

```env
PORT=paste your port to this (exp.: 8080)

// Remote MongoDB
DB_HOST=projectsviewer-i36ga.azure.mongodb.net
DB_NAME=filmslibrary
DB_USERNAME=dbProjectAdmin
DB_PASSWORD=qwerty123456
```

#### *Клиент*

Так же вам необходимо продублировать файл _.env.example_ с именем _.env_, в каталоге с клиентом и проприсать в нем параметры для подключения к серверу, что прописывать указано ниже:

```env
REACT_APP_SERVER_HOST=localhost
REACT_APP_SERVER_PORT=порт какой вы указали серверу
```

### **Автоматически запуск через Docker**

Для запуска приложения вам нужно установить docker и docker compose:

- [Windows](https://hub.docker.com/editions/community/docker-ce-desktop-windows)
- [Linux](https://docs.docker.com/install/linux/docker-ce/debian/)

После установки выполните команду:

```cmd
docker-compose up
```

### **Самостоятельно**

Чтобы запустить сервер и клиент, вам необходимо установить зависимости через _npm_ или _yarn_, для этого у вас на компьютере должен быть установлен [_Node.js_](https://nodejs.org/).

Вам необходимо установить пакеты 3 раза, отдельно для сервера, клиента, а также пакет в корневом каталоге, чтобы одновременно запустить сервер и клиент.

В корневом каталоге запустите команду

```cmd
npm install
```

или

```cmd
yarn install
```

и дождитесь установки зависимостей.

***Для клиента, а также для сервера проведите такие же действия по установке зависимостей, перейдя в соответствующие папки.***

Для запуска проекта используйте команду, в корневом каталоге:

```cmd
npm run start
```

или

```cmd
yarn start
```

## **Архитектура**

<div style='text-align:center;'>
    <img src='https://i.ibb.co/HGzmktD/image.png' atl='Архитектура' />
</div>

### **Сервер (server):**

Каталог/Файл | Описание
-|-
*config* | для хранения конфигов
*routes* | настройка роутов
*controllers* | логика, из роутов вызываються методы контроллера
*models* | модели для MongoDB
*utils* | промежуточные обработчики
*middlewares* | воспомагательные компоненты
*app.js* | настройка сервера
*server.js* | инициализация и запуск сервера

#### **Подробное описание:**

#### **config**

Название | Описание
-|-
base | стандартный конфиг с базовыми настройками
database | переменные для настройки подключения к базы данных

#### **routes**

<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th width="20%">Точка входа</th>
            <th style="text-align:center">Тип</th>
            <th>Описание</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td width="20%">/api/v1/films</td>
            <td style="text-align:center"><em>GET</em></td>
            <td>вывод фильмов; поиск через Query Params; пагинация по 10 на странице</td>
        </tr>
        <tr>
            <td width="20%">/api/v1/films</td>
            <td style="text-align:center"><em>POST</em></td>
            <td>добавление фильма с формы</td>
        </tr>
        <tr>
            <td width="20%">/api/v1/films/import</td>
            <td style="text-align:center"><em>POST</em></td>
            <td>импорт фильмов с файла</td>
        </tr>
        <tr>
            <td width="20%">/api/v1/films/:filmId</td>
            <td style="text-align:center"><em>GET</em></td>
            <td>информация про фильм по ID</td>
        </tr>
        <tr>
            <td width="20%">/api/v1/films/:filmId</td>
            <td style="text-align:center"><em>PATCH</em></td>
            <td>обновления информации про фильм по ID (не реализовано на клиенте, но работает на API). PATCH выбран для
                того чтобы можна было обновить только требующую для обновления информацию, а не весь объект, так как PUT
                обновляет весь объект.</td>
        </tr>
        <tr>
            <td width="20%">/api/v1/films/:filmId</td>
            <td style="text-align:center"><em>DELETE</em></td>
            <td>удаление фильма по ID</td>
        </tr>
    </tbody>
</table>

#### **controllers**

Название | Описание
-|-
film | контроллер с методами для работы с фильмами

#### **models** - модели для MongoDB

- ***Film***

Название | Тип | Описание
-|-|-
title | *String* | Название
release_year | *Number* | Год выпуска
format | *String* | Формат
stars | *String* | Список актёров

#### **middlewares**

Название | Описание
-|-
validator | Валидаторы для форм
upload | Настройки multer для получения файла с клиета

#### **utils**

Название | Описание
-|-
database | методы для подключения к базе даных
parseFile | методы для парсина данных с файла
routes | устанощик роутов, для того что бы не забывать логику app.js

### **Клиент (client):**

Каталог/Файл | Описание
-|-
*components* | глупые компоненты для отображения данных на екране
*config* | конфиги
*helpers* | воспомагательные компоненты
*pages* | контейнеры страниц
*providers* | сервисы для работы с API
*redux* | состояние приложения (стор)
*style* | стили
*routes.js* | настройка роутинга приложения
*App.js* | главный компонент App
*index.js* | инициализация приложения, с подключением роутинга и стора

#### **Подробное описание:**

#### **components**

Компонент | Описание
-|-
CreateFilm | форма создания фильма
FilmDetail | отображения информации про фильм
Film | компоненты для списка фильмов (List, Item, Pagination)
Search | форма для поиска
Loader | лоадер
MessageBox | елемент для вивода ошибок или успешных сообщений
Navbar | навигация

#### **config**

Конфиг | Описание
-|-
default | стандартный конфиг

#### **helpers**

Название | Описание
-|-
history | создание истории для роутинга

#### **pages**

Страница | Описание
-|-
Films | контейнер с логикой для работы со списком фильмамов
FilmDetail | контейнер с логикой для работы с информацией про фильм
CreateFilm | контейнер с логикой для создания фильма

#### **providers**

Название | Описание
-|-
api | создание экземпляра axios с конфигурацией
film | екземпляр класса с методами работы с API

#### **redux**

Название | Описание
-|-
films | настройка стора для фильмов (types, actions, reducer)
message | настройка стора для сообщений об ошибках или успешних виполнениях  (types, actions, reducer)
reduces.js | комбинирует разные редьюсеры в один rootReducer
store.js | создание стора и подключение middleware redux-thunk для работы с асинхронными методами в экшенах

#### **style**

Название | Описание
-|-
main.css | основные стили

## **Баг трекер**

Нашли ошибку или нужна новая функция? [Пожалуйста, откройте новую issue](https://github.com/taruuuch/films-library/issues/new).

## **Изменения**

Подробные изменения для каждой версии документированы в [release notes](https://github.com/taruuuch/films-library/releases).

## **Лицензия**

Copyright (c) 2020 [Artemchuk Dmytro](https://github.com/taruuuch)

[The MIT License](https://opensource.org/licenses/MIT)
